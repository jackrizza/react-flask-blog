{"ast":null,"code":"\"use strict\";\n\nvar _storageUtilities = _interopRequireDefault(require(\"storage-utilities\"));\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n}), exports.default = void 0;\n\nfunction _interopRequireDefault(a) {\n  return a && a.__esModule ? a : {\n    default: a\n  };\n}\n\nvar emit = function emit(a, b, c) {\n  return new Promise(function () {\n    var d = 0,\n        e = setInterval(function () {\n      d++ >= c.timeout && clearInterval(e);\n      var f = new CustomEvent(c.eventName, {\n        detail: b\n      });\n      a[b.key] === b.value && (window.dispatchEvent(f), clearInterval(e));\n    }, 10);\n  });\n},\n    getEventName = function getEventName(a) {\n  return a.eventName || a.targetName + \"StorageChanged\";\n},\n    getTimeout = function getTimeout(a) {\n  return a.timeout ? a.timeout / 10 : 15;\n},\n    getTarget = function getTarget(a) {\n  return \"string\" == typeof a ? window[\"\".concat(a, \"Storage\")] : a;\n},\n    getTargetName = function getTargetName(a) {\n  return \"string\" == typeof a ? \"session\" === a ? \"session\" : \"local\" : a === window.sessionStorage ? \"session\" : \"local\";\n},\n    _default = function _default(a, b) {\n  var c = b || {};\n  c.targetName = getTargetName(a), c.eventName = getEventName(c), c.timeout = getTimeout(c);\n  var d = getTarget(a),\n      e = d.setItem.bind(d),\n      f = d.removeItem.bind(d);\n  d.setItem = function (a, b) {\n    var f = _storageUtilities.default.stringify(b);\n\n    emit(d, {\n      key: a,\n      value: f,\n      _target: c.targetName\n    }, c), e(a, f);\n  }, d.removeItem = function (a) {\n    emit(d, {\n      key: a,\n      _target: c.targetName\n    }, c), f(a);\n  };\n};\n\nexports.default = _default;","map":null,"metadata":{},"sourceType":"script"}